This change is merged from both branches.
